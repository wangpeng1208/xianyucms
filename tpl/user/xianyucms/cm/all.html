{notempty name="list"}
{volist name="list" id="xianyu"}
{php}
$image=ps_getavatar($xianyu['cm_uid'],$xianyu['api'][0]['avatar'])['small'];
$lou=$total-(($page-1)*$limit)-$i+1;{/php}
<li id="li{$xianyu['cm_id']}" class="comment-item fn-clear">
<div class="comment-avatar"><a href="{:xianyu_user_url('user/home/index',array('id'=>$xianyu['cm_uid']))}" target="_blank"><img src="{$image}" alt="{$value['nickname']}"></a><div class="comment-lou">{$lou}楼</div></div>
<div class="comment-post">
<div class="comment-post-arrow"></div>
<div class="comment-post-cnt">
<div class="comment-body">
<div class="comment-top"><span class="user"><a href="{:xianyu_user_url('user/home/index',array('id'=>$xianyu['cm_uid']))}" target="_blank">{$xianyu["nickname"]}</a></span>:<span class="time">{:date('m-d H:i',$xianyu['cm_addtime'])}</span></div>
<div class="comment-text">{:get_emots(remove_xss(strip_tags($xianyu['cm_content'])))}</div>
<div class="comment-assist fn-clear">
<p class="fn-left"><span class="digg"><a href="javascript:void(0)" class="sup" data-id="{$xianyu['cm_id']}" data-type="sup" data="{:xianyu_user_url('user/cm/digg',array('id'=>$xianyu['cm_id'],'type'=>'sup'))}">支持(<strong>{$xianyu['cm_support']}</strong>)</a></span><span class="digg"><a href="javascript:void(0)" class="opp" data-id="{$xianyu['cm_id']}" data-type="opp" data="{:xianyu_user_url('user/cm/digg',array('id'=>$xianyu['cm_id'],'type'=>'opp'))}">反对(<strong>{$xianyu['cm_oppose']}</strong>)</a></span></p>
<p class="fn-right"><a href="javascript:void(0)" data-id="{$xianyu['cm_id']}" data-pid="{$xianyu['cm_pid']}" data-vid="{$xianyu['cm_vid']}" data-sid="{$xianyu['cm_sid']}" data-tuid="{$xianyu['cm_uid']}" class="reply">回复</a></p>
</div>
<div id="rep{$xianyu["cm_id"]}" class="comms"></div>
</div>
{notempty name="xianyu.cm_sub"}
{volist name="xianyu.cm_sub" id="sub" key="kkk"}
{php}$sublou=count($xianyu['cm_sub'])-$kkk+1;{/php}
<div class="comment-sub">
<div class="comment-top"><span class="sublou">{$sublou}楼</span><span class="user"><a href={:xianyu_user_url('user/home/index',array('id'=>$sub['cm_uid']))}" target="_blank">{$sub["nickname"]}</a></span> : {notempty name="sub.cm_tub"}回复了 <a href="{:xianyu_user_url('user/home/index',array('id'=>$sub.cm_tub['cm_uid']),true,true)}" target='_blank'>{$sub.cm_tub['nickname']}</a>{/notempty}<span class="time">{:date("m-d H:i",$sub['cm_addtime'])}</span></div>
<div class="comment-text">{:get_emots(remove_xss(strip_tags($sub["cm_content"])))}</div>
<div class="comment-assist fn-clear">
<p class="fn-left"><span class="digg"><a href="javascript:void(0)" class="sup" data-id="{$xianyu['cm_id']}" data-type="sup" data="{:xianyu_user_url('user/cm/digg',array('id'=>$sub['cm_id'],'type'=>'sup'))}">支持(<strong>{$sub["cm_support"]}</strong>)</a></span><span class="digg"><a href="javascript:void(0)" class="opp" data-id="{$xianyu['cm_id']}" data-type="opp" data="{:xianyu_user_url('user/cm/digg',array('id'=>$sub['cm_id'],'type'=>'opp'))}">反对(<strong>{$sub['cm_oppose']}</strong>)</a></span></p>
<p class="fn-right"><a href="javascript:void(0)" data-id="{$sub['cm_id']}" data-pid="{$xianyu['cm_id']}" data-vid="{$xianyu['cm_vid']}" data-sid="{$xianyu['cm_sid']}" data-tuid="{$sub['cm_uid']}" class="reply">回复</a></p>
</div>
<div id="rep{$sub['cm_id']}" class="comms"></div>
</div>
{/volist}
{/notempty}
</div>
<div class="fn-clear"></div>
</div>
</li>
{/volist}
{/notempty}  